---
- name: Install FreeBSD system packages
  pkgng: name="libssh2" state=present

- name: Create /usr/local/etc/telegraf directory
  file: path=/usr/local/etc/telegraf state=directory mode=0755
  tags:
    - config

- name: Setting telegraf flags
  lineinfile: dest=/etc/rc.conf regexp=^telegraf_flags= line=telegraf_flags="\"-config-directory /usr/local/etc/telegraf\""
  tags:
    - config

- name: Install activator monitoring
  template:
    src: "etc/telegraf/telegraf.d/noc-activator.conf.j2"
    dest: "/usr/local/etc/telegraf/noc-activator.conf"
  notify: restart telegraf
  tags:
    - config