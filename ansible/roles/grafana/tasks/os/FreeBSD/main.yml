---
- name: Create Grafana config
  template:
    src: grafana.ini
    dest: /usr/local/etc/grafana2.conf
  notify: restart grafana
  tags:
    - config

# Do not work, becouse RC script can't handle "grafana2_conf" variable properly
#- name: Setting Grafana conf file
#  lineinfile: dest=/etc/rc.conf regexp=^grafana2_conf= line=grafana2_conf=\"{{ noc_root }}/var/etc/grafana/grafana.ini\"

- name: Install Grafana
  pkgng: name="grafana2" state=present

- name: Create Grafana directories
  file: path={{item}} state=directory owner={{grafana_user}} mode=0755
  with_items:
    - /var/run/grafana2
    - /var/log/grafana2
