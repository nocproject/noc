---
- name: Add InfluxDB GPG key
  rpm_key:
    key: https://repos.influxdata.com/influxdb.key
    state: present
  environment:
    https_proxy: "{{http_proxy}}"
    http_proxy: "{{http_proxy}}"
  tags:
    - repo

- name: Add InfluxDB repository
  template:
    src: os/CentOS/etc/yum.repos.d/influxdb.repo.j2
    dest: /etc/yum.repos.d/influxdb.repo
  tags:
    - repo

- name: Install CentOS packages
  yum:
    name: influxdb
    state: present
    update_cache: yes
  environment:
    https_proxy: "{{http_proxy}}"
    http_proxy: "{{http_proxy}}"

