- name: "Create lvm {{vg_fast_name}}"
  lvg:
    vg: "{{vg_fast_name}}"
    pvs: "{{vg_fast_device}}"
    pesize: 32
  when: vg_fast_device != vg_device

- name: set same name for vg_fast_device and vg_device
  set_fact:
    vg_fast_name: "{{vg_name}}"
  when: vg_fast_device == vg_device

- name: create wal storage
  lvol:
    vg: "{{vg_fast_name}}"
    lv: wal
    size: "{{wal_lv_size}}"

- name: format wal storage
  filesystem:
    fstype: "{{wal_fs}}"
    dev: "/dev/{{vg_name}}/wal"

- name: create wal dir
  file:
    name: "{{wal_mount_point}}"
    state: directory

- name: Mount wal storage
  mount:
    name: "{{wal_mount_point}}"
    src: "/dev/{{vg_name}}/wal"
    fstype: "{{wal_fs}}"
    state: present

- name: create mongo data storage
  lvol:
    vg: "{{vg_name}}"
    lv: mongo_data
    size: "{{mongo_data_lv_size}}"

- name: format mongo data storage
  filesystem:
    fstype: "{{mongo_data_fs}}"
    dev: "/dev/{{vg_name}}/mongo_data"

- name: create mongo data dir
  file:
    name: "{{mongo_data_mount_point}}"
    state: directory

- name: Mount mongo data storage
  mount:
    name: "{{mongo_data_mount_point}}"
    src: "/dev/{{vg_name}}/mongo_data"
    fstype: "{{mongo_data_fs}}"
    state: present

- name: create mongo index storage
  lvol:
    vg: "{{vg_name}}"
    lv: mongo_index
    size: "{{mongo_index_lv_size}}"

- name: format mongo index storage
  filesystem:
    fstype: "{{mongo_index_fs}}"
    dev: "/dev/{{vg_name}}/mongo_index"

- name: create mongo data dir
  file:
    name: "{{mongo_index_mount_point}}"
    state: directory

- name: Mount mongo index storage
  mount:
    name: "{{mongo_index_mount_point}}"
    src: "/dev/{{vg_name}}/mongo_index"
    fstype: "{{mongo_index_fs}}"
    state: present