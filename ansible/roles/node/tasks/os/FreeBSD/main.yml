---
- name: Install FreeBSD system packages
  pkgng: name={{item}} state=present
  with_items:
    - ca_root_nss
    - postgresql93-client
    - python2
    - py27-virtualenv
    - mercurial
    - sudo
    - quilt
    - curl
    - libffi
  tags:
    - requirements

- name: Create rc.d directory
  file: path=/usr/local/etc/rc.d state=directory mode=0755

- name: Install supervisord init script
  template: src="os/FreeBSD/etc/rc.d/noc.j2" dest="/usr/local/etc/rc.d/{{ noc_system_service }}" mode="a+rx"

- name: Ensure /etc/rc.conf exists
  file: path=/etc/rc.conf state=touch

- name: Enable NOC system service
  service: name="{{ noc_system_service }}" enabled=yes

- name: Create newsyslog.conf.d directory
  file: path=/usr/local/etc/newsyslog.conf.d state=directory mode=0755

- include: "telegraf.yml"
