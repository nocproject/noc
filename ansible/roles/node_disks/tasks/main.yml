- name: "Include OS-specific tasks"
  include: "os/{{ ansible_distribution }}/main.yml"

- name: "Create lvm {{vg_name}}"
  lvg:
    vg: "{{vg_name}}"
    pvs: "{{vg_device}}"
    pesize: 32

- name: create nsq storage
  lvol:
    vg: "{{vg_name}}"
    lv: nsq_cache
    size: "{{nsq_cache_lv_size}}"
  ignore_errors: yes

- name: format nsq storage
  filesystem:
    fstype: "{{nsq_cache_fs}}"
    dev: "/dev/{{vg_name}}/nsq_cache"
    force: no

- name: Mount nsq storage
  mount:
    name: "{{nsq_cache_mount_point}}"
    src: "/dev/{{vg_name}}/nsq_cache"
    fstype: "{{nsq_cache_fs}}"
    state: present

- name: create opt storage
  lvol:
    vg: "{{vg_name}}"
    lv: opt
    size: "{{opt_lv_size}}"
  ignore_errors: yes

- name: format opt storage
  filesystem:
    fstype: "{{opt_fs}}"
    dev: "/dev/{{vg_name}}/opt"
    force: no

- name: Mount opt storage
  mount:
    name: "{{opt_mount_point}}"
    src: "/dev/{{vg_name}}/opt"
    fstype: "{{opt_fs}}"
    state: present