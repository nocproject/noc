---
- name: install nsqlookupd.service file
  template:
     src: "etc/systemd/system/nsqlookupd.service"
     dest: "/etc/systemd/system/nsqlookupd.service"
  register: nsqlookupd_service

- name: Install nsqlookupd monitoring
  template:
    src: "etc/telegraf/telegraf.d/nsqlookupd.conf.j2"
    dest: "/etc/telegraf/telegraf.d/nsqlookupd.conf"
  notify: reload telegraf
  tags:
    - config

- name: reload systemd
  shell: systemctl daemon-reload
  when: nsqlookupd_service.changed
