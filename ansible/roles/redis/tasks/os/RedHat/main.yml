---
- name: Ensure redis is installed.
  yum:
    name: redis
    state: installed
  environment:
    http_proxy: "{{http_proxy}}"
  tags:
    - redis

- name: Override systemd defaults for redis
  template:
    src: "etc/systemd/system/redis.service.d/override.conf"
    dest: "/etc/systemd/system/redis.service.d/override.conf"
  notify: systemd daemon-reload

- name: enable overcommit in sysctl
  sysctl:
    name: vm.overcommit_memory
    value: 1
    state: present
    reload: yes
    ignoreerrors: yes
