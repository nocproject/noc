---
- name: Install and upgrade NOC
  hosts: nodes
  become: yes
  any_errors_fatal: true
  roles:
    - role: pre

    - role: node
      when: "'nodes' in group_names"
      
    - role: dev
      when: "'svc-dev' in group_names or 'svc-notebook' in group_names"

    - role: mongod
      when: "'svc-mongod' in group_names"

    - role: postgres
      when: "'svc-postgres' in group_names"

    - role: influxdb
      when: "'svc-influxdb' in group_names"

    - role: migrate
      when: "'svc-mongod-master' in group_names"

    - role: web
      when: "'svc-web' in group_names"

    - role: notebook
      when: "'svc-notebook' in group_names"

    - role: nginx
      when: "'svc-nginx' in group_names"

    - role: omap
      when: "'svc-omap' in group_names"

    - role: fmwriter
      when: "'svc-fmwriter' in group_names"

    - role: activator
      when: "'svc-activator' in group_names"

    - role: classifier
      when: "'svc-classifier' in group_names"

    - role: correlator
      when: "'svc-correlator' in group_names"

    - role: syslogcollector
      when: "'svc-syslogcollector' in group_names"

    - role: trapcollector
      when: "'svc-trapcollector' in group_names"

    - role: grafana
      when: "'svc-grafana' in group_names"

    - role: ping
      when: "'svc-ping' in group_names"

    - role: sae
      when: "'svc-sae' in group_names"

    - role: discovery
      when: "'svc-discovery' in group_names"

    - role: post
