# FirmWare Policy

## Описание

Политика ПО позволяет настраивать поведение системы в зависимости от версии ПО устройства. 
Доступны следующие политики:

* Рекомендовано (`Recommended`) - рекомендуемая версия для устройства
* Применимо (`Acceptable`) - Допустимая версия ПО для устройства
* Не рекомендовано (`Not Recommended`) - не рекомендованная версия
* Запрещено (`Denied`) - эксплуатация данной версии ПО запрещена


## Настройки

Настройка начинается в пункте меню `Учёт объектов (Inventory) -> Настройки (Setup) -> Политика версий прошивок (Firmware Policy)`. 
После нажатия на кнопку `Add` открывается форма создания внешней системы с пунктами:

* **Платформа** (`Platform`) - ограничение на платформу устройства
* **Версия** (`FirmWare`) - Версия ПО
* **Условие** (`Condition`) - условие для срабатывания политики (сравнение с выбранной версией)
* **Политика** (`Status`) - политика
* **Описание** (`Description`) - Текстовое описание политики
* **Метки** (`Labels`) - назначенные метки [Labels](../label/index.md)
* `Management`

Также доступны настройки реакции системы на запрещающую политику (`Denied`). Они расположены на вкладке `Box` 
в профиле объекта [Manged Object Profile](../managed-object-profile/index.md#Box(Полный_опрос)), пункт `On Denied Firmware`:

* `Ignore` - игнорировать и продолжить опрос
* `Ignore&Stop` - игнорировать и остановить опрос. Опрос останавливается после `Version`.
* `Raise Alarm` - поднять аварию с классом `NOC | Managed Object | Denied Firmware` и продолжить опрос.
* `Raise Alarm&Stop` - поднять аварию и остановить опрос

<!-- prettier-ignore -->
!!! info
    Политика `Stop` остановит только текущему опрос. При следующем проверка повторится

## Механизм работы

Проверка политик происходит во время опроса версии [Version Discovery](../../../../admin/reference/discovery/box/version.md). 
При определении действующей политики действует приоритет запрета. Т.е. в первую очередь рассматриваются политики `Denied`, 
затем `Not Recommended` и так далее. Если действует политика `Denied`, 
то поведение системы определяется настройками `On Denied Firmware` [Manged Object Profile](../managed-object-profile/index.md#Box(Полный_опрос)). 
Это может быть остановка опроса на этапе запроса версии, поднятие аварии, либо игнорирование.

Также в политике можно выставлять разрешённые протоколы для работы с устройством, но данный функционал не реализован.

Если среди действующих на устройство [Manged Object](../managed-object/index.md) есть политики
 с метками [Labels](../label/index.md), разрешёнными для назначения устройству, то они перетекут в его `effective_labels`.

## Отображение

Действующая политика отображается в карточке устройства (`Managed Object Card`). 
Также в отчёте `Управление объектами (Service Activation) -> Отчёты (Reports) -> Сводка по объектам (Managed Object Summary)`. 
При выборе типа отчёта *По версии* (`By Version`) будет выведена колонка по действующей политике.
