[
    {
        "name": "Network | BGP | Peer Down",
        "description": "A",
        "is_unique": true,
        "discriminator": ["peer"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "PeerDS",
                "datasource": "peer.Peer",
                "search": {
                    "peer": "peer"
                }
            }
        ],
        "vars": [
            {
                "name": "peer",
                "description": "BGP Peer",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "vrf",
                "description": "VRF",
                "type": "str",
                "required": true
            },
            {
                "name": "as",
                "description": "BGP Peer AS",
                "type": "int",
                "required": false,
                "default": "=PeerDS.remote_asn"
            },

            {
                "name": "local_as",
                "description": "Local AS",
                "type": "int",
                "required": false,
                "default": "=PeerDS.local_asn"
            },
            {
                "name": "description",
                "description": "BGP Peer Description",
                "type": "str",
                "required": false,
                "default": "=PeerDS.description"
            },
            {
                "name": "import_filter",
                "description": "BGP Import Filter",
                "type": "str",
                "required": false,
                "default": "=PeerDS.import_filter"
            },
            {
                "name": "export_filter",
                "description": "BGP Export Filter",
                "type": "str",
                "required": false,
                "default": "=PeerDS.export_filter"
            }
        ],
        "text": {
            "en": {
                "subject_template": "BGP Peer {{peer}}{%if vrf %} vrf {{vrf}}{% endif %}{% if as %} (AS{{as}}{% if description %}, {{description}}{% endif %}){% endif %} session down",
                "body_template": "BGP Peer {{peer}}{%if vrf %} vrf {{vrf}}{% endif %}{% if as %} (AS{{as}}{% if description %}, {{description}}{% endif %}){% endif %} session down\n{% if local_as %}Local AS: AS{{local_as}}\nRemote AS: AS{{as}} ({{description}})\nImport Filter: {{import_filter}}\nExport Filter: {{export_filter}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Network | BGP | Prefix Limit Exceeded",
        "description": "A",
        "is_unique": true,
        "discriminator": ["peer"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "vars": [
            {
                "name": "peer",
                "description": "BGP Peer",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "vrf",
                "description": "VRF",
                "type": "str",
                "required": true
            },
            {
                "name": "as",
                "description": "BGP Peer AS",
                "type": "int",
                "required": false
            }
        ],
        "text": {
            "en": {
                "subject_template": "BGP Peer {{peer}}{%if vrf %}vrf {{vrf}}{% endif %}{% if as %} (AS{{as}}){% endif %} prefix limit exceeded",
                "body_template": "BGP Peer {{peer}}{%if vrf %}vrf {{vrf}}{% endif %}{% if as %} (AS{{as}}){% endif %} prefix limit exceeded",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    }
]
