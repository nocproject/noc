[
    {
        "name": "Network | Link | Err-Disable",
        "description": "Link in err-disable state",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "interface name"
            },
            {
                "name": "reason",
                "description": "err-disable reason"
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "Link err-disable: {{interface}}{% if description %} ({{description}}){% endif %} ({{reason}})",
                "body_template": "Link err-disable: {{interface}}{% if description %} ({{description}}){% endif %} ({{reason}})",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        },
        "root_cause": [
            {
                "name": "UDLD",
                "root__name": "Network | UDLD | UDLD Protocol Error Detected",
                "window": 10,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__interface": "alarm.vars['interface']"
                }
            }
        ]
    },

    {
        "name": "Network | Link | Half-Duplex",
        "description": "Link going into half-duplex state",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "MINOR",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "interface name"
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "Link going into half-duplex state: {{interface}}{% if description %} ({{description}}){% endif %}",
                "body_template": "Link going into half-duplex state: {{interface}}{% if description %} ({{description}}){% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Network | Link | Link Down",
        "description": "Link down",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "interface name"
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            },
            {
                "name": "link",
                "description": "Link ID",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.link"
            }
        ],
        "text": {
            "en": {
                "subject_template": "Link down: {{interface}}{% if description %} ({{description}}){% endif %}",
                "body_template": "Link down: {{interface}}{% if description %} ({{description}}){% endif %}",
                "symptoms": "Connection lost",
                "probable_causes": "Administrative action, cable damage, hardware or software error either from this or from another side",
                "recommended_actions": "Check configuration, both sides of links and hardware"
            }
        },
        "root_cause": [
            {
                "name": "Other side link down",
                "root__name": "Network | Link | Link Down",
                "window": 60,
                "condition": "alarm.vars.get('link') is not None",
                "match_condition": {
                    "vars__link": "alarm.vars['link']"
                }
            },
            {
                "name": "Linecard Down",
                "root__name": "Chassis | Linecard | LC Down",
                "window": 30,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__number": "alarm.managed_object.profile.get_linecard(alarm.vars['interface'])"
                }
            },
            {
                "name": "LBD Loop",
                "root__name": "Network | LBD | Loop Detected",
                "window": 10,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__interface": "alarm.vars['interface']"
                }
            },
            {
                "name": "STP Loop Detected",
                "root__name": "Network | STP | STP Loop Detected",
                "window": 10,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__interface": "alarm.vars['interface']"
                }
            },
            {
                "name": "err-disable",
                "root__name": "Network | Link | Err-Disable",
                "window": 10,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__interface": "alarm.vars['interface']"
                }
            },
            {
                "name": "Hardware Port Error",
                "root__name": "Chassis | Hardware | Hardware Port Error",
                "window": 10,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__interface": "alarm.vars['interface']"
                }
            },
            {
                "name": "DOM Out of Threshold",
                "root__name": "Network | Link | DOM | Alarm: Out of Threshold",
                "window": 10,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__interface": "alarm.vars['interface']"
                }
            }
        ],
        "jobs": [
            {
                "job": "check_link",
                "interval": 60,
                "vars": {
                    "interface": "alarm.vars['interface']"
                }
            }
        ]
    },

    {
        "name": "Network | Link | DOM | Warning: Out of Threshold",
        "description": "DOM above or below threshold exceeded",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Physical port",
                "type": "str",
                "required": true
            },
            {
                "name": "threshold",
                "description": "Threshold type",
                "type": "str",
                "required": false
            },
            {
                "name": "sensor",
                "description": "Measured name",
                "type": "str",
                "required": false
            },
            {
                "name": "ovalue",
                "description": "Operating value",
                "type": "str",
                "required": false
            },
            {
                "name": "tvalue",
                "description": "Threshold value",
                "type": "str",
                "required": false
            }
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "DOM exceeded the{% if sensor %} {{sensor}}{% endif %}{% if threshold %} {{threshold}}{% endif %} threshold: {{interface}}{% if description %} ({{description}}){% endif %}",
                "body_template": "DOM exceeded the{% if sensor %} {{sensor}}{% endif %}{% if threshold %} {{threshold}}{% endif %} threshold: {{interface}}{% if description %} ({{description}}){% endif %}{% if ovalue %}, Operating value {{ovalue}}{% endif %}{% if tvalue %}, Threshold value {{tvalue}}{% endif %}",
                "symptoms": "Connection lost",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Network | Link | DOM | Alarm: Out of Threshold",
        "description": "DOM above or below threshold exceeded",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "CRITICAL",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Physical port",
                "type": "str",
                "required": true
            },
            {
                "name": "threshold",
                "description": "Threshold type",
                "type": "str",
                "required": false
            },
            {
                "name": "sensor",
                "description": "Measured name",
                "type": "str",
                "required": false
            },
            {
                "name": "ovalue",
                "description": "Operating value",
                "type": "str",
                "required": false
            },
            {
                "name": "tvalue",
                "description": "Threshold value",
                "type": "str",
                "required": false
            }
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "DOM exceeded the{% if sensor %} {{sensor}}{% endif %}{% if threshold %} {{threshold}}{% endif %} threshold: {{interface}}{% if description %} ({{description}}){% endif %}",
                "body_template": "DOM exceeded the{% if sensor %} {{sensor}}{% endif %}{% if threshold %} {{threshold}}{% endif %} threshold: {{interface}}{% if description %} ({{description}}){% endif %}{% if ovalue %}, Operating value {{ovalue}}{% endif %}{% if tvalue %}, Threshold value {{tvalue}}{% endif %}",
                "symptoms": "Connection lost",
                "probable_causes": "",
                "recommended_actions": ""
            }
        },
        "root_cause": [
            {
                "name": "Warning: Out of Threshold",
                "root__name": "Network | Link | DOM | Warning: Out of Threshold",
                "window": 30,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__interface": "alarm.vars['interface']"
                }
            }
        ]
    }
]
