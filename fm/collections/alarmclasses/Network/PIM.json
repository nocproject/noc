[
    {
        "name": "Network | PIM | Neighbor Down",
        "description": "PIM neighbor down",
        "is_unique": true,
        "discriminator": ["interface", "neighbor"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "neighbor",
                "description": "Neighbor's IP",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "vrf",
                "description": "VRF",
                "type": "str",
                "required": false
            },
            {
                "name": "reason",
                "description": "Reason",
                "type": "str",
                "required": false
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "PIM neighbor {{neighbor}} DOWN on {{interface}}{% if description %} ({{description}}){% endif %}.{% if vrf %} VRF {{vrf}}.{% endif %}",
                "body_template": "PIM neighbor {{neighbor}} DOWN on {{interface}}{% if description %} ({{description}}){% endif %}.{% if vrf %} VRF {{vrf}}.{% endif %}{% if reason %} Reason: {{reason}}.{% endif %}",
                "symptoms": "Multicast flows lost",
                "probable_causes": "Link failure or protocol misconfiguration",
                "recommended_actions": "Check links and local and neighbor router configuration" 
            }
        },
        "root_cause": [
            {
                "name": "Link Down",
                "root__name": "Network | Link | Link Down",
                "window": 10,
                "match_condition": {
                    "managed_object": "alarm.managed_object.id",
                    "vars__interface": "alarm.managed_object.profile.root_interface(alarm.vars['interface'])" 
                }
            }
        ]
    },

    {
        "name": "Network | PIM | DR Change",
        "description": "Designated Router Change",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "INFO",
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "from_dr",
                "description": "From DR",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "to_dr",
                "description": "To DR",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "vrf",
                "description": "VRF",
                "type": "str",
                "required": false
            }
        ],
        "text": {
            "en": {
                "subject_template": "PIM DR change from neighbor {{from_dr}} to {{to_dr}} on interface {{interface}}.{% if vrf %} VRF {{vrf}}.{% endif %}",
                "body_template": "PIM Designated Router change from neighbor {{from_dr}} to {{to_dr}} on interface {{interface}}.{% if vrf %} VRF {{vrf}}.{% endif %}",
                "symptoms": "Some multicast flows lost",
                "probable_causes": "Link failure or protocol misconfiguration",
                "recommended_actions": "Check links and local and neighbor router configuration" 
            }
        }
    },

    {
        "name": "Network | PIM | Invalid RP",
        "description": "Received Register or Join for invalid RP",
        "is_unique": true,
        "discriminator": ["invalid_rp"],
        "user_clearable": true,
        "default_severity__name": "INFO",
        "vars": [
            {
                "name": "pim_router",
                "description": "PIM router IP",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "invalid_rp",
                "description": "Invalid RP IP",
                "type": "ip_address",
                "required": true
            }
        ],
        "text": {
            "en": {
                "subject_template": "Received Register or Join from PIM router {{pim_router}} for invalid RP {{invalid_rp}}.",
                "body_template": "Received Register or Join from PIM router {{pim_router}} for invalid RP {{invalid_rp}}.",
                "symptoms": "",
                "probable_causes": "A PIM router received a register message from another PIM router that identifies itself as the rendezvous point. If the router is not configured for another rendezvous point, it will not accept the register message.",
                "recommended_actions": "Configure all leaf routers (first-hop routers to multicast sources) with the IP address of the valid rendezvous point." 
            }
        }
    }
]
