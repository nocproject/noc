[
    {
        "name": "Network | DOCSIS | Invalid DOCSIS Message",
        "description": "Invalid DOCSIS Message received from a Cable Modem",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "Invalid DOCSIS Message received from a Cable Modem{% if mac %} {{mac}},{% endif %}{% if sid %} {{sid}},{% endif %} {% if interface %}interface {{interface}}{% endif %}",
                "body_template": "Invalid DOCSIS Message received from a Cable Modem{% if mac %} {{mac}},{% endif %}{% if sid %} {{sid}},{% endif %} {% if interface %}interface {{interface}}{% endif %}",
                "symptoms": "",
                "probable_causes": "A cable modem that is not DOCSIS-compliant has attempted to send an invalid DOCSIS message.",
                "recommended_actions": "Locate the cable modem that sent this message and replace it with DOCSIS-compliant modem."
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": false
            },
            {
                "name": "mac",
                "description": "Cable Modem MAC",
                "type": "mac",
                "required": false
            },
            {
                "name": "sid",
                "description": "Cable Modem SID",
                "type": "int",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | Invalid DOCSIS Message"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Bad Timing Offset",
        "description": "Bad timing offset detected for Cable Modem",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "Bad timing offset {% if offset %}{{offset}}{% endif %} detected for Cable Modem{% if mac %} {{mac}}{% endif %}{% if sid %} {{sid}}{% endif %}",
                "body_template": "Bad timing offset {% if offset %}{{offset}}{% endif %} detected for Cable Modem{% if mac %} {{mac}}{% endif %}{% if sid %} {{sid}}{% endif %}",
                "symptoms": "",
                "probable_causes": "The cable modem is not using the correct starting offset during initial ranging, causing a zero, negative timing offset to be recorded by the CMTS for this modem. The CMTS internal algorithms that rely on the timing offset parameter will not analyze any modems that do not use the correct starting offset. The modems may not be able to function, depending on their physical location on the cable plant.",
                "recommended_actions": "Locate the cable modem based on the MAC address and report the initial timing offset problem to the cable modem vendor."
            }
        },
        "vars": [
            {
                "name": "mac",
                "description": "Cable Modem MAC",
                "type": "mac",
                "required": false
            },
            {
                "name": "sid",
                "description": "Cable Modem SID",
                "type": "int",
                "required": false
            },
            {
                "name": "offset",
                "description": "Time offset",
                "type": "str",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | Bad Timing Offset"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Max CPE Reached",
        "description": "Maximum number of CPE reached",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "New host with{% if ip %} IP {{ip}}{% endif %}{% if mac %} MAC {{mac}}{% endif %} on modem{% if modem_mac %} MAC {{modem_mac}}{% endif %}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %} is ignored",
                "body_template": "New host with{% if ip %} IP {{ip}}{% endif %}{% if mac %} MAC {{mac}}{% endif %} on modem{% if modem_mac %} MAC {{modem_mac}}{% endif %}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %} is ignored",
                "symptoms": "",
                "probable_causes": "The maximum number of devices that can be attached to the cable modem has been exceeded. Therefore, the device with the specified IP address will not be added to the modem with the specified SID.",
                "recommended_actions": "Locate the specified device and place the device on a different cable modem with another SID." 
            }
        },
        "vars": [
            {
                "name": "mac",
                "description": "CPE MAC",
                "type": "mac",
                "required": false
            },
            {
                "name": "ip",
                "description": "CPE IP",
                "type": "ip_address",
                "required": false
            },
            {
                "name": "modem_mac",
                "description": "Cable Modem MAC",
                "type": "mac",
                "required": false
            },
            {
                "name": "sid",
                "description": "Cable Modem SID",
                "type": "int",
                "required": false
            },
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | Max CPE Reached"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Invalid Shared Secret",
        "description": "Invalid Shared Secret",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "Authorization failed for Cable Modem {{mac}}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %}",
                "body_template": "Authorization failed for Cable Modem {{mac}}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %}",
                "symptoms": "",
                "probable_causes": "The registration of this modem has failed because of an invalid MIC string.",
                "recommended_actions": "Ensure that the shared secret that is in the configuration file is the same as the shared secret that is configured in the cable modem."
            }
        },
        "vars": [
            {
                "name": "mac",
                "description": "Cable Modem MAC",
                "type": "mac",
                "required": true
            },
            {
                "name": "sid",
                "description": "Cable Modem SID",
                "type": "int",
                "required": false
            },
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | Invalid Shared Secret"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | BPI Unautorized",
        "description": "Invalid Shared Secret",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "BPI authorization failed for Cable Modem {{mac}}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %}",
                "body_template": "BPI authorization failed for Cable Modem {{mac}}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %}",
                "symptoms": "",
                "probable_causes": "An unauthorized cable modem has been deleted to enforce BPI authorization for the specified cable modem. The specified cable modem was not performing BPI negotiation.",
                "recommended_actions": "Check the modem interface configuration for privacy mandatory, or check for errors in the TFTP configuration file."
            }
        },
        "vars": [
            {
                "name": "mac",
                "description": "Cable Modem MAC",
                "type": "mac",
                "required": true
            },
            {
                "name": "sid",
                "description": "Cable Modem SID",
                "type": "int",
                "required": false
            },
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | BPI Unautorized"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Invalid CoS",
        "description": "Invalid or unsupported CoS setting",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "Registration failed for Cable Modem {{mac}}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %}",
                "body_template": "Registration failed for Cable Modem {{mac}}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %}",
                "symptoms": "",
                "probable_causes": "The registration of the specified modem has failed because of an invalid or unsupported CoS setting.",
                "recommended_actions": "Ensure that the CoS fields in the configuration file are set correctly."
            }
        },
        "vars": [
            {
                "name": "mac",
                "description": "Cable Modem MAC",
                "type": "mac",
                "required": true
            },
            {
                "name": "sid",
                "description": "Cable Modem SID",
                "type": "int",
                "required": false
            },
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | Invalid CoS"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Invalid QoS",
        "description": "Invalid or unsupported QoS setting",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "Registration failed for Cable Modem {{mac}}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %}",
                "body_template": "Registration failed for Cable Modem {{mac}}{% if sid %} SID {{sid}}{% endif %}{% if interface %} on interface {{interface}}{% endif %}",
                "symptoms": "",
                "probable_causes": "The registration of the specified modem has failed because of an invalid or unsupported QoS setting.",
                "recommended_actions": "Ensure that the QoS fields in the configuration file are set correctly."
            }
        },
        "vars": [
            {
                "name": "mac",
                "description": "Cable Modem MAC",
                "type": "mac",
                "required": true
            },
            {
                "name": "sid",
                "description": "Cable Modem SID",
                "type": "int",
                "required": false
            },
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | Invalid QoS"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Maximum SIDs",
        "description": "The maximum number of SIDs has been allocated",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "Maximum number of SIDS have been allocated for interface {{interface}}",
                "body_template": "Maximum number of SIDS have been allocated for interface",
                "symptoms": "",
                "probable_causes": "The maximum number of SIDs has been allocated to the specified line card.",
                "recommended_actions": "Assign the cable modem to another line card."
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": true
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | Maximum SIDs"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Maximum Capacity Reached",
        "description": "Current total reservation exceeds maximum configured reservation",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "Current total reservation{% if cur_bps %} {{cur_bps}} bps{% endif %} on iterface {{interface}}{% if upstream %} U {{upstream}}{% endif %} exceeds its maximum configured reservation limit{% if res_bps %} of {{res_bps}} bps{% endif %}",
                "body_template": "Current total reservation{% if cur_bps %} {{cur_bps}} bps{% endif %} on iterface {{interface}}{% if upstream %} U {{upstream}}{% endif %} exceeds its maximum configured reservation limit{% if res_bps %} of {{res_bps}} bps{% endif %}",
                "symptoms": "",
                "probable_causes": "The currently reserved capacity on the upstream channel already exceeds its virtual reservation capacity, based on the configured subscription level limit. Increasing the subscription level limit on the current upstream channel will place you at risk of being unable to guarantee the individual reserved rates for modems since this upstream channel is already oversubscribed.",
                "recommended_actions": "Load-balance the modems that are requesting the reserved upstream rate on another upstream channel."
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "upstream",
                "description": "Upstream",
                "type": "str",
                "required": false
            },
            {
                "name": "cur_bps",
                "description": "Current bps reservation",
                "type": "int",
                "required": false
            },
            {
                "name": "res_bps",
                "description": "Reserved bps",
                "type": "int",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | DOCSIS | Maximum Capacity Reached"
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Unregistered Modem Deleted",
        "description": "CMTS deleted unregistered Cable Modem",
        "action": "A",
        "text" : {
            "en": {
                "subject_template": "CMTS deleted unregistered Cable Modem {{mac}}",
                "body_template": "CMTS deleted unregistered Cable Modem {{mac}}",
                "symptoms": "",
                "probable_causes": "An unregistered cable modem has been deleted to avoid unaccounted bandwidth usage.",
                "recommended_actions": "Check the cable modem interface configuration for registration bypass, or check for errors in the TFTP configuration file. "
            }
        },
        "vars": [
            {
                "name": "mac",
                "description": "Cable Modem MAC",
                "type": "mac",
                "required": true
            }
        ],
        "disposition": [ ],
        "repeat_suppression": [
            {
                "name": "Do not suppress after cable modem has been deleted",
                "event_class__name": "Network | DOCSIS | Unregistered Modem Deleted",
                "window": 450,
                "match_condition": {
                    "managed_object": "event.managed_object.id",
                    "vars__mac": "vars['mac']"
                },
                "suppress": true
            }
        ]
    },

    {
        "name": "Network | DOCSIS | Upstream Input Power Level Changed",
        "description": "The upstream channel input power level has been changed.",
        "action": "A",
        "text" : {
            "en": {
                "subject_template": "Interface {{interface}}{% if upstream %} U {{upstream}}{% endif %} power level changed to {{power}} dBmV",
                "body_template": "Interface {{interface}}{% if upstream %} U {{upstream}}{% endif %} power level changed to {{power}} dBmV",
                "symptoms": "",
                "probable_causes": "The upstream channel input power level has been changed.",
                "recommended_actions": ""
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "upstream",
                "description": "Upstream",
                "type": "str",
                "required": false
            },
            {
                "name": "power",
                "description": "Input power",
                "type": "int",
                "required": true
            }
        ],
        "disposition": [ ]
    },

    {
        "name": "Network | DOCSIS | Upstream Frequency Changed",
        "description": "The upstream channel frequency has been changed.",
        "action": "A",
        "text" : {
            "en": {
                "subject_template": "Interface {{interface}}{% if upstream %} U {{upstream}}{% endif %} frequency changed to {{frequency}} MHz",
                "body_template": "Interface {{interface}}{% if upstream %} U {{upstream}}{% endif %} frequency changed to {{frequency}} MHz",
                "symptoms": "",
                "probable_causes": "The upstream channel frequency has been changed.",
                "recommended_actions": ""
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "upstream",
                "description": "Upstream",
                "type": "str",
                "required": false
            },
            {
                "name": "frequency",
                "description": "Frequency",
                "type": "str",
                "required": true
            }
        ],
        "disposition": [ ]
    },

    {
        "name": "Network | DOCSIS | Channel Width Changed",
        "description": "The upstream channel width has been changed.",
        "action": "A",
        "text" : {
            "en": {
                "subject_template": "Interface {{interface}}{% if upstream %} U {{upstream}}{% endif %} channel width changed to {{width}} kHz",
                "body_template": "Interface {{interface}}{% if upstream %} U {{upstream}}{% endif %} channel width changed to {{width}} kHz",
                "symptoms": "",
                "probable_causes": "The upstream channel frequency has been changed.",
                "recommended_actions": ""
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Cable interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "upstream",
                "description": "Upstream",
                "type": "str",
                "required": false
            },
            {
                "name": "width",
                "description": "Channel width",
                "type": "str",
                "required": true
            }
        ],
        "disposition": [ ]
    }

]