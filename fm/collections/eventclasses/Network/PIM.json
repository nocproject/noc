[
    {
        "name": "Network | PIM | Neighbor Up",
        "description": "PIM Neighbor up",
        "action": "A",
        "text" : {
            "en": {
                "subject_template": "PIM neighbor {{neighbor}} UP on {{interface}}.{% if vrf %} VRF {{vrf}}.{% endif %}",
                "body_template": "PIM neighbor {{neighbor}} UP on {{interface}}.{% if vrf %} VRF {{vrf}}.{% endif %}",
                "symptoms": "Multicast flows send successfully",
                "probable_causes": "PIM successfully established connect with neighbor",
                "recommended_actions": "No reaction needed" 
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "neighbor",
                "description": "Neighbor's IP",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "vrf",
                "description": "VRF",
                "type": "str",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "clear",
                "alarm_class__name": "Network | PIM | Neighbor Down" 
            }
        ]
    },

    {
        "name": "Network | PIM | Neighbor Down",
        "description": "PIM Neighbor down",
        "action": "A",
        "text" : {
            "en": {
                "subject_template": "PIM neighbor {{neighbor}} DOWN on {{interface}}.{% if vrf %} VRF {{vrf}}.{% endif %}",
                "body_template": "PIM neighbor {{neighbor}} DOWN on {{interface}}.{% if vrf %} VRF {{vrf}}.{% endif %}{% if reason %} Reason: {{reason}}.{% endif %}",
                "symptoms": "Multicast flows lost",
                "probable_causes": "PIM protocol configuration problem or link failure",
                "recommended_actions": "Check links and local and neighbor's router configuration" 
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "neighbor",
                "description": "Neighbor's IP",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "vrf",
                "description": "VRF",
                "type": "str",
                "required": false
            },
            {
                "name": "reason",
                "description": "Reason",
                "type": "str",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | PIM | Neighbor Down" 
            }
        ]
    },

    {
        "name": "Network | PIM | DR Change",
        "description": "Designated Router Change",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "PIM DR change from neighbor {{from_dr}} to {{to_dr}} on interface {{interface}}.{% if vrf %} VRF {{vrf}}.{% endif %}",
                "body_template": "PIM DR change from neighbor {{from_dr}} to {{to_dr}} on interface {{interface}}.{% if vrf %} VRF {{vrf}}.{% endif %}",
                "symptoms": "Some multicast flows lost",
                "probable_causes": "PIM protocol configuration problem or link failure",
                "recommended_actions": "Check links and local and neighbor's router configuration" 
            }
        },
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "from_dr",
                "description": "From DR",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "to_dr",
                "description": "To DR",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "vrf",
                "description": "VRF",
                "type": "str",
                "required": false
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | PIM | DR Change" 
            }
        ]
    },

    {
        "name": "Network | PIM | Invalid RP",
        "description": "Received Register or Join for invalid RP",
        "action": "L",
        "text" : {
            "en": {
                "subject_template": "Received Register or Join from PIM router {{pim_router}} for invalid RP {{invalid_rp}}.",
                "body_template": "Received Register or Join from PIM router {{pim_router}} for invalid RP {{invalid_rp}}.",
                "symptoms": "",
                "probable_causes": "A PIM router received a register message from another PIM router that identifies itself as the rendezvous point. If the router is not configured for another rendezvous point, it will not accept the register message.",
                "recommended_actions": "Configure all leaf routers (first-hop routers to multicast sources) with the IP address of the valid rendezvous point." 
            }
        },
        "vars": [
            {
                "name": "pim_router",
                "description": "PIM Router IP",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "invalid_rp",
                "description": "Invalid RP IP",
                "type": "ip_address",
                "required": true
            }
        ],
        "disposition": [
            {
                "name": "dispose",
                "action": "raise",
                "alarm_class__name": "Network | PIM | Invalid RP" 
            }
        ]
    }
]
