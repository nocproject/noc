{
    "name": "Security | Authentication | SNMP Authentication Failure",
    "$collection": "fm.eventclasses",
    "uuid": "91094f01-18a3-4fdf-849b-26de6e751b61",
    "description": "SNMP authentication failure",
    "action": "A",
    "vars": [
        {
            "name": "ip",
            "description": "Request source address",
            "type": "ip_address",
            "required": true
        },
        {
            "name": "community",
            "description": "Request SNMP community",
            "type": "str",
            "required": false
        }
    ],
    "subject_template": "SNMP Authentication Failure for {{ip}} {% if community %}(community: {{community}}){% endif %}",
    "body_template": "SNMP request from {{ip}} {% if community %}with community '{{community}}'{% endif %} has been denied by security policy",
    "symptoms": "NOC, NMS and monitoring systems cannot interact with the box over SNMP protocol",
    "probable_causes": "SNMP server is misconfigured, community mismatch, misconfigured ACL or brute-force attack in progress",
    "recommended_actions": "Check SNMP configuration",
    "disposition": [
        {
            "name": "misconfiguration",
            "condition": "event.vars['ip'] in NOC_ACTIVATORS",
            "action": "raise",
            "alarm_class__name": "NOC | Managed Object | Configuration Errors | Misconfigured SNMP"
        }
    ],
    "repeat_suppression": [
        {
            "name": "Workaround for console flood",
            "condition": "True",
            "event_class__name": "Security | Authentication | SNMP Authentication Failure",
            "match_condition": {
                "managed_object": "event.managed_object.id",
                "vars__ip": "vars['ip']"
            },
            "window": 900,
            "suppress": true
        }
    ]
}
