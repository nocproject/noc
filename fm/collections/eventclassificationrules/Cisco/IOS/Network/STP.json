[
    {
        "name": "Cisco | IOS | Network | STP | Topology Changed PVST (SNMP)",
        "description": "BRIDGE-MIB::topologyChange",
        "event_class__name": "Network | STP | Topology Changed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^CISCO-VTP-MIB::vtpVlanIndex\\..+$",
                "value_re": "^(?P<vlan>\\d+)$"
            },
            {
                "key_re": "^IF-MIB::ifName\\.\\d+$",
                "value_re": "^(?P<interface>.+)$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^BRIDGE-MIB::topologyChange$"
            }
        ]
    },
    
    {
        "name": "Cisco | IOS | Network | STP | Topology Changed MSTP (SNMP)",
        "description": "BRIDGE-MIB::topologyChange",
        "event_class__name": "Network | STP | Topology Changed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^CISCO-STP-EXTENSIONS-MIB::stpxMSTInstanceIndex\\.\\d+$",
                "value_re": "^(?P<instance>\\d+)$"
            },
            {
                "key_re": "^IF-MIB::ifName\\.\\d+$",
                "value_re": "^(?P<interface>.+)$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^BRIDGE-MIB::topologyChange$"
            }
        ]
    },

    {
        "name": "Cisco | IOS | Network | STP | BPDU Guard Violation (SYSLOG)",
        "description": "%PM-SP-4-ERR_DISABLE: bpduguard error detected on Gi4/1, putting Gi4/1 in err-disable state",
        "event_class__name": "Network | STP | BPDU Guard Violation",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^message$",
                "value_re": "%PM(-SP)?-4-ERR_DISABLE: bpduguard error detected on (?P<interface>\\S+), putting \\S+ in err-disable state"
            }
        ]
    },

    {
        "name": "Cisco | IOS | Network | STP | BPDU Guard Recovery (SYSLOG)",
        "description": "%PM-4-ERR_RECOVER: Attempting to recover from bpduguard err-disable state on Gi0/24",
        "event_class__name": "Network | STP | BPDU Guard Recovery",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^message$",
                "value_re": "%PM(-SP)?-4-ERR_RECOVER: Attempting to recover from bpduguard err-disable state on (?P<interface>\\S+)"
            }
        ]
    },

    {
        "name": "Cisco | IOS | Network | STP | STP Vlan Loop Detected (SYSLOG)",
        "description": "%SPANTREE-2-LOOPGUARD_BLOCK: Loop guard blocking port GigabitEthernet0/39 on VLAN0252.",
        "event_class__name": "Network | STP | STP Vlan Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^message$",
                "value_re": "%(?:SPANTREE|STP)-2-LOOPGUARD_BLOCK: Loop guard blocking port (?P<interface>\\S+) on VLAN(?P<vlan>\\d+)."
            }
        ]
    },

    {
        "name": "Cisco | IOS | Network | STP | STP Vlan Loop Cleared (SYSLOG)",
        "description": "%SPANTREE-2-LOOPGUARD_UNBLOCK: Loop guard unblocking port GigabitEthernet0/39 on VLAN0252.",
        "event_class__name": "Network | STP | STP Vlan Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^message$",
                "value_re": "%(?:SPANTREE|STP)-2-LOOPGUARD_(?:UN)?BLOCK: Loop guard unblocking port (?P<interface>\\S+) on VLAN(?P<vlan>\\d+)."
            }
        ]
    },

    {
        "name": "Cisco | IOS | Network | STP | STP Vlan Loop Detected (SNMP)",
        "description": "CISCO-SYSLOG-MIB::ciscoSyslogMIBNotificationPrefix",
        "event_class__name": "Network | STP | STP Vlan Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^CISCO-SYSLOG-MIB::ciscoSyslogMIBNotificationPrefix$"
            },
            {
                "key_re": "^CISCO-SYSLOG-MIB::clogHistFacility\\.\\d+$",
                "value_re": "^SPANTREE-SP$"
            },
            {
                "key_re": "^CISCO-SYSLOG-MIB::clogHistMsgName\\.\\d+$",
                "value_re": "^LOOPGUARD_BLOCK$"
            },
            {
                "key_re": "^CISCO-SYSLOG-MIB::clogHistMsgText\\.\\d+$",
                "value_re": "^Loop guard blocking port (?P<interface>\\S+) on VLAN(?P<vlan>\\d+)\\.$"
            }
        ]
    },

    {
        "name": "Cisco | IOS | Network | STP | STP Vlan Loop Cleared (SNMP)",
        "description": "CISCO-SYSLOG-MIB::ciscoSyslogMIBNotificationPrefix",
        "event_class__name": "Network | STP | STP Vlan Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^CISCO-SYSLOG-MIB::ciscoSyslogMIBNotificationPrefix$"
            },
            {
                "key_re": "^CISCO-SYSLOG-MIB::clogHistFacility\\.\\d+$",
                "value_re": "^SPANTREE-SP$"
            },
            {
                "key_re": "^CISCO-SYSLOG-MIB::clogHistMsgName\\.\\d+$",
                "value_re": "^LOOPGUARD_(?:UN)?BLOCK$"
            },
            {
                "key_re": "^CISCO-SYSLOG-MIB::clogHistMsgText\\.\\d+$",
                "value_re": "^Loop guard unblocking port (?P<interface>\\S+) on VLAN(?P<vlan>\\d+)\\.$"
            }
        ]
    },

    {
        "name": "Cisco | IOS | Network | STP | STP instances exceeded (SYSLOG)",
        "description": "%SPANTREE_VLAN_SW-2-MAX_INSTANCE: Platform limit of 128 STP instances exceeded. No instance created for VLAN192 (port Gi0/1).",
        "event_class__name": "Network | STP | STP instances exceeded",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^message$",
                "value_re": "%SPANTREE_VLAN_SW-2-MAX_INSTANCE: Platform limit of (?P<limit>\\d+) STP instances exceeded"
            }
        ]
    }
]
