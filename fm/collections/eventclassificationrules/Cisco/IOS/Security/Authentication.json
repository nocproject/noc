[
    {
        "name": "Cisco | IOS | Security | Authentication | SNMP Authentication Failure (SNMP)",
        "description": "Security | Authentication | SNMP Authentication Failure",
        "event_class__name": "Security | Authentication | SNMP Authentication Failure",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^SNMPv2-MIB::snmpTraps$"
            },
            {
                "key_re": "^CISCO-SNMP-TARGET-EXT-MIB::cExtSnmpTargetAuthInetAddr\\.0$",
                "value_re": "^(?P<ip>\\S+)$"
            }
        ]
    },
    
   {
       "name": "Cisco | IOS | Security | Authentication | Logout (SYSLOG)",
       "description": "%SYS-6-EXIT_CONFIG: User has exited tty ",
       "event_class__name": "Security | Authentication | Logout",
       "preference": 1000,
       "patterns": [
           {
               "key_re": "^source$",
               "value_re": "^syslog$"
           },
           {
               "key_re": "^profile$",
               "value_re": "^Cisco\\.IOS$"
           },
           {
               "key_re": "^message$",
               "value_re": "%SYS-6-EXIT_CONFIG: User (?P<user>.+?) has exited tty session \\d+\\s*\\((?P<ip>\\S+)\\)$"
           }
       ]
   },

    {
        "name": "Cisco | IOS | Security | Authentication | Authentication Failed (SNMP)",
        "description": "SNMPv2-MIB::authenticationFailure",
        "event_class__name": "Security | Authentication | Authentication Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^OLD-CISCO-SYSTEM-MIB::authAddr\\.0$",
                "value_re": "^(?P<ip__bin_to_ip>.+)$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^(?:SNMPv2-MIB::authenticationFailure|SNMPv2-MIB::snmpTraps)$"
            }
        ]
    },
   
    {
        "name": "Cisco | IOS | Security | Authentication | Login (SYSLOG)",
        "description": "%SEC_LOGIN-5-LOGIN_SUCCESS: Login Success [user: admin] [Source: 172.16.0.22] [localport: 22] at 13:14:14 MSK Wed Aug 3 2011",
        "event_class__name": "Security | Authentication | Login",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$" 
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$" 
            },
            {
                "key_re": "^message$",
                "value_re": "%SEC_LOGIN-5-LOGIN_SUCCESS: Login Success \\[user: (?P<user>.*)\\] \\[Source: (?P<ip>\\S+)\\] \\[localport: (?P<lport>\\d+)\\]" 
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Authentication | Login Failed (SYSLOG)",
        "description": "%SEC_LOGIN-4-LOGIN_FAILED: Login failed [user: ] [Source: 172.16.0.22] [localport: 22] [Reason: Login Authentication Failed]",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$" 
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$" 
            },
            {
                "key_re": "^message$",
                "value_re": "%SEC_LOGIN-4-LOGIN_FAILED: Login failed \\[user: (?P<user>.*)\\] \\[Source: (?P<ip>\\S+)\\] \\[localport: (?P<lport>.+)\\] \\[Reason: Login Authentication Failed\\]" 
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Authentication | SSH - Login (SYSLOG)",
        "description": "%SSH-5-SSH2_USERAUTH: User 'admin' authentication for SSH2 Session from 172.16.0.22 (tty = 1) using crypto cipher 'aes256-cbc', hmac 'hmac-sha1' Succeeded",
        "event_class__name": "Security | Authentication | Login",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$" 
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$" 
            },
            {
                "key_re": "^message$",
                "value_re": "%SSH-5-SSH2_USERAUTH: User '(?P<user>.*)' authentication for SSH2 Session from (?P<ip>\\S+) \\(tty = (?P<vty>\\d+)\\) using crypto cipher '\\S+', hmac '\\S+' Succeeded$" 
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Authentication | SSH - Login Failed (SYSLOG)",
        "description": "%SSH-5-SSH2_USERAUTH: User 'admin' authentication for SSH2 Session from 172.16.0.22 (tty = 1) using crypto cipher 'aes256-cbc', hmac 'hmac-sha1' Failed",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$" 
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$" 
            },
            {
                "key_re": "^message$",
                "value_re": "%SSH-5-SSH2_USERAUTH: User '(?P<user>.*)' authentication for SSH2 Session from (?P<ip>\\S+) \\(tty = (?P<vty>\\d+)\\) using crypto cipher '\\S+', hmac '\\S+' Failed$" 
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Authentication | SSH - Logout (SYSLOG)",
        "description": "%SSH-5-SSH2_CLOSE: SSH2 Session from 172.16.0.22 (tty = 1) for user 'admin' using crypto cipher 'aes256-cbc', hmac 'hmac-sha1' closed",
        "event_class__name": "Security | Authentication | Logout",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$" 
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$" 
            },
            {
                "key_re": "^message$",
                "value_re": "%SSH-5-SSH2_CLOSE: SSH2 Session from (?P<ip>\\S+) \\(tty = (?P<vty>\\d+)\\) for user '(?P<user>.*)' using crypto cipher '\\S+', hmac '\\S+' closed$" 
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Authentication | Logout (SNMP)",
        "description": "CISCO-SMI::cisco",
        "event_class__name": "Security | Authentication | Logout",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^CISCO-SMI::cisco$"
            },
            {
                "key_re": "^OLD-CISCO-TS-MIB::tslineSesType\\.(?:[1-4])\\.1$",
                "value_re": "^(?:tcp|telnet|rlogin|rshell)$"
            },
            {
                "key_re": "^RFC1213-MIB::tcpConnState\\.\\d+\\.\\d+\\.\\d+\\.\\d+\\.(?:22|23|80)\\.(?P<ip>\\d+\\.\\d+\\.\\d+\\.\\d+)\\.\\d+$",
                "value_re": "^(?:synReceived|finWait1|closed|finWait2|closeWait|timeWait)$"
            },
            {
                "key_re": "^OLD-CISCO-TS-MIB::tsLineUser\\.(?:[1-4])$",
                "value_re": "^(?P<user>\\S+)$"
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Authentication | SSH - Unexpected message type (SYSLOG)",
        "description": "%SSH-4-SSH2_UNEXPECTED_MSG: Unexpected message type has arrived. Terminating the connection",
        "event_class__name": "Security | Authentication | Login Failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^message$",
                "value_re": "%SSH-4-SSH2_UNEXPECTED_MSG: Unexpected message type"
            }
        ]
    },

    {
        "name": "Cisco | IOS | Security | Authentication | RADIUS server failed (SYSLOG)",
        "description": "%RADIUS-4-RADIUS_DEAD: RADIUS server 10.50.245.20:1812,1813 is not responding.",
        "event_class__name": "Security | Authentication | RADIUS server failed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Cisco\\.IOS$"
            },
            {
                "key_re": "^message$",
                "value_re": "%RADIUS-4-RADIUS_DEAD: RADIUS server (?P<ip>\\S+):\\d+,\\d+ is not responding\\."
            }
        ]
    }
]
