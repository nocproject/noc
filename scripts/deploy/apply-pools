#!./bin/python
# -*- coding: utf-8 -*-
##----------------------------------------------------------------------
## Create required pools
##----------------------------------------------------------------------
## Copyright (C) 2007-2015 The NOC Project
## See LICENSE for details
##----------------------------------------------------------------------

# Python modules
import sys
import json
# NOC modules
from noc.main.models.pool import Pool


def main():
    with open("etc/noc.json") as f:
        data = json.load(f, encoding="utf-8")
    changed = False
    for p in data["pools"]:
        try:
            pool = Pool.objects.get(name=p)
            if pool.description != data["pools"][p]["description"]:
                p.description = data["pools"][p]["description"]
                p.save()
                changed = True
        except Pool.DoesNotExist:
            Pool(
                name=p["name"],
                description=data["pools"][p]["description"]
            ).save()
            changed = True
    if changed:
        print "CHANGED"
    else:
        print "OK"


if __name__ == "__main__":
    main()
