// Generated by CoffeeScript 1.10.0
(function() {
  Ext.define('Report.board.Menu', {
    extend: 'Ext.toolbar.Toolbar',
    xtype: 'boardMenu',
    items: [
      {
        xtype: 'segmentedbutton',
        items: [
          {
            text: 'Сегодня',
            handler: 'currentDay'
          }, {
            text: 'Вчера',
            handler: 'yesterday'
          }, {
            text: 'Неделя',
            handler: 'week'
          }, {
            text: 'Месяц',
            handler: 'month'
          }, {
            text: 'Квартал',
            handler: 'quarter'
          }, {
            text: 'Год',
            handler: 'year'
          }
        ]
      }, {
        itemId: 'from',
        xtype: 'datefield',
        fieldLabel: 'с',
        listeners: {
          change: 'dateFrom'
        }
      }, {
        itemId: 'to',
        xtype: 'datefield',
        fieldLabel: 'по',
        listeners: {
          change: 'dateTo'
        }
      }, '->', {
        xtype: 'button',
        text: 'Добавить виджет',
        handler: 'addWidget'
      }
    ],
    currentDay: function() {
      return this.sliceTo(new Date);
    },
    yesterday: function() {
      return this.sliceToMargin('DAY', 1);
    },
    week: function() {
      return this.sliceToMargin('DAY', 7);
    },
    month: function() {
      return this.sliceToMargin('MONTH', 1);
    },
    quarter: function() {
      return this.sliceToMargin('MONTH', 7);
    },
    year: function() {
      return this.sliceToMargin('YEAR', 1);
    },
    dateFrom: function(widget, value) {
      return this.slice(value, this.toFieldValue());
    },
    dateTo: function(widget, value) {
      return this.slice(this.fromFieldValue(), value);
    },
    addWidget: function() {
      return this.fireEvent('addWidget', this);
    },
    privates: {
      sliceDateToMargin: function(type, count) {
        return this.sliceTo(this.dateMargin(type, count));
      },
      sliceDateTo: function(to) {
        return this.slice(new Date, to);
      },
      slice: function(from, to) {
        return Report.data.Mediator.sliceDateStream(from, to);
      },
      fromFieldValue: function() {
        return this.down('#to').getValue();
      },
      toFieldValue: function() {
        return this.down('#from').getValue();
      },
      dateMargin: function(type, count) {
        return Ext.Date.add(new Date, Ext.Date[type], -count);
      }
    }
  });

}).call(this);

//# sourceMappingURL=Menu.js.map
